{"ast":null,"code":"/** @license\r\n * eventsource.js\r\n * Available under MIT License (MIT)\r\n * https://github.com/Yaffle/EventSource/\r\n */\n\n/*jslint indent: 2, vars: true, plusplus: true */\n\n/*global setTimeout, clearTimeout */\n(function (global) {\n  \"use strict\";\n\n  var setTimeout = global.setTimeout;\n  var clearTimeout = global.clearTimeout;\n  var XMLHttpRequest = global.XMLHttpRequest;\n  var XDomainRequest = global.XDomainRequest;\n  var ActiveXObject = global.ActiveXObject;\n  var NativeEventSource = global.EventSource;\n  var document = global.document;\n  var Promise = global.Promise;\n  var fetch = global.fetch;\n  var Response = global.Response;\n  var TextDecoder = global.TextDecoder;\n  var TextEncoder = global.TextEncoder;\n  var AbortController = global.AbortController;\n\n  if (typeof window !== \"undefined\" && typeof document !== \"undefined\" && !(\"readyState\" in document) && document.body == null) {\n    // Firefox 2\n    document.readyState = \"loading\";\n    window.addEventListener(\"load\", function (event) {\n      document.readyState = \"complete\";\n    }, false);\n  }\n\n  if (XMLHttpRequest == null && ActiveXObject != null) {\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest_in_IE6\n    XMLHttpRequest = function () {\n      return new ActiveXObject(\"Microsoft.XMLHTTP\");\n    };\n  }\n\n  if (Object.create == undefined) {\n    Object.create = function (C) {\n      function F() {}\n\n      F.prototype = C;\n      return new F();\n    };\n  }\n\n  if (!Date.now) {\n    Date.now = function now() {\n      return new Date().getTime();\n    };\n  } // see #118 (Promise#finally with polyfilled Promise)\n  // see #123 (data URLs crash Edge)\n  // see #125 (CSP violations)\n  // see pull/#138\n  // => No way to polyfill Promise#finally\n\n\n  if (AbortController == undefined) {\n    var originalFetch2 = fetch;\n\n    fetch = function (url, options) {\n      var signal = options.signal;\n      return originalFetch2(url, {\n        headers: options.headers,\n        credentials: options.credentials,\n        cache: options.cache\n      }).then(function (response) {\n        var reader = response.body.getReader();\n        signal._reader = reader;\n\n        if (signal._aborted) {\n          signal._reader.cancel();\n        }\n\n        return {\n          status: response.status,\n          statusText: response.statusText,\n          headers: response.headers,\n          body: {\n            getReader: function () {\n              return reader;\n            }\n          }\n        };\n      });\n    };\n\n    AbortController = function () {\n      this.signal = {\n        _reader: null,\n        _aborted: false\n      };\n\n      this.abort = function () {\n        if (this.signal._reader != null) {\n          this.signal._reader.cancel();\n        }\n\n        this.signal._aborted = true;\n      };\n    };\n  }\n\n  function TextDecoderPolyfill() {\n    this.bitsNeeded = 0;\n    this.codePoint = 0;\n  }\n\n  TextDecoderPolyfill.prototype.decode = function (octets) {\n    function valid(codePoint, shift, octetsCount) {\n      if (octetsCount === 1) {\n        return codePoint >= 0x0080 >> shift && codePoint << shift <= 0x07FF;\n      }\n\n      if (octetsCount === 2) {\n        return codePoint >= 0x0800 >> shift && codePoint << shift <= 0xD7FF || codePoint >= 0xE000 >> shift && codePoint << shift <= 0xFFFF;\n      }\n\n      if (octetsCount === 3) {\n        return codePoint >= 0x010000 >> shift && codePoint << shift <= 0x10FFFF;\n      }\n\n      throw new Error();\n    }\n\n    function octetsCount(bitsNeeded, codePoint) {\n      if (bitsNeeded === 6 * 1) {\n        return codePoint >> 6 > 15 ? 3 : codePoint > 31 ? 2 : 1;\n      }\n\n      if (bitsNeeded === 6 * 2) {\n        return codePoint > 15 ? 3 : 2;\n      }\n\n      if (bitsNeeded === 6 * 3) {\n        return 3;\n      }\n\n      throw new Error();\n    }\n\n    var REPLACER = 0xFFFD;\n    var string = \"\";\n    var bitsNeeded = this.bitsNeeded;\n    var codePoint = this.codePoint;\n\n    for (var i = 0; i < octets.length; i += 1) {\n      var octet = octets[i];\n\n      if (bitsNeeded !== 0) {\n        if (octet < 128 || octet > 191 || !valid(codePoint << 6 | octet & 63, bitsNeeded - 6, octetsCount(bitsNeeded, codePoint))) {\n          bitsNeeded = 0;\n          codePoint = REPLACER;\n          string += String.fromCharCode(codePoint);\n        }\n      }\n\n      if (bitsNeeded === 0) {\n        if (octet >= 0 && octet <= 127) {\n          bitsNeeded = 0;\n          codePoint = octet;\n        } else if (octet >= 192 && octet <= 223) {\n          bitsNeeded = 6 * 1;\n          codePoint = octet & 31;\n        } else if (octet >= 224 && octet <= 239) {\n          bitsNeeded = 6 * 2;\n          codePoint = octet & 15;\n        } else if (octet >= 240 && octet <= 247) {\n          bitsNeeded = 6 * 3;\n          codePoint = octet & 7;\n        } else {\n          bitsNeeded = 0;\n          codePoint = REPLACER;\n        }\n\n        if (bitsNeeded !== 0 && !valid(codePoint, bitsNeeded, octetsCount(bitsNeeded, codePoint))) {\n          bitsNeeded = 0;\n          codePoint = REPLACER;\n        }\n      } else {\n        bitsNeeded -= 6;\n        codePoint = codePoint << 6 | octet & 63;\n      }\n\n      if (bitsNeeded === 0) {\n        if (codePoint <= 0xFFFF) {\n          string += String.fromCharCode(codePoint);\n        } else {\n          string += String.fromCharCode(0xD800 + (codePoint - 0xFFFF - 1 >> 10));\n          string += String.fromCharCode(0xDC00 + (codePoint - 0xFFFF - 1 & 0x3FF));\n        }\n      }\n    }\n\n    this.bitsNeeded = bitsNeeded;\n    this.codePoint = codePoint;\n    return string;\n  }; // Firefox < 38 throws an error with stream option\n\n\n  var supportsStreamOption = function () {\n    try {\n      return new TextDecoder().decode(new TextEncoder().encode(\"test\"), {\n        stream: true\n      }) === \"test\";\n    } catch (error) {\n      console.debug(\"TextDecoder does not support streaming option. Using polyfill instead: \" + error);\n    }\n\n    return false;\n  }; // IE, Edge\n\n\n  if (TextDecoder == undefined || TextEncoder == undefined || !supportsStreamOption()) {\n    TextDecoder = TextDecoderPolyfill;\n  }\n\n  var k = function () {};\n\n  function XHRWrapper(xhr) {\n    this.withCredentials = false;\n    this.readyState = 0;\n    this.status = 0;\n    this.statusText = \"\";\n    this.responseText = \"\";\n    this.onprogress = k;\n    this.onload = k;\n    this.onerror = k;\n    this.onreadystatechange = k;\n    this._contentType = \"\";\n    this._xhr = xhr;\n    this._sendTimeout = 0;\n    this._abort = k;\n  }\n\n  XHRWrapper.prototype.open = function (method, url) {\n    this._abort(true);\n\n    var that = this;\n    var xhr = this._xhr;\n    var state = 1;\n    var timeout = 0;\n\n    this._abort = function (silent) {\n      if (that._sendTimeout !== 0) {\n        clearTimeout(that._sendTimeout);\n        that._sendTimeout = 0;\n      }\n\n      if (state === 1 || state === 2 || state === 3) {\n        state = 4;\n        xhr.onload = k;\n        xhr.onerror = k;\n        xhr.onabort = k;\n        xhr.onprogress = k;\n        xhr.onreadystatechange = k; // IE 8 - 9: XDomainRequest#abort() does not fire any event\n        // Opera < 10: XMLHttpRequest#abort() does not fire any event\n\n        xhr.abort();\n\n        if (timeout !== 0) {\n          clearTimeout(timeout);\n          timeout = 0;\n        }\n\n        if (!silent) {\n          that.readyState = 4;\n          that.onabort(null);\n          that.onreadystatechange();\n        }\n      }\n\n      state = 0;\n    };\n\n    var onStart = function () {\n      if (state === 1) {\n        //state = 2;\n        var status = 0;\n        var statusText = \"\";\n        var contentType = undefined;\n\n        if (!(\"contentType\" in xhr)) {\n          try {\n            status = xhr.status;\n            statusText = xhr.statusText;\n            contentType = xhr.getResponseHeader(\"Content-Type\");\n          } catch (error) {\n            // IE < 10 throws exception for `xhr.status` when xhr.readyState === 2 || xhr.readyState === 3\n            // Opera < 11 throws exception for `xhr.status` when xhr.readyState === 2\n            // https://bugs.webkit.org/show_bug.cgi?id=29121\n            status = 0;\n            statusText = \"\";\n            contentType = undefined; // Firefox < 14, Chrome ?, Safari ?\n            // https://bugs.webkit.org/show_bug.cgi?id=29658\n            // https://bugs.webkit.org/show_bug.cgi?id=77854\n          }\n        } else {\n          status = 200;\n          statusText = \"OK\";\n          contentType = xhr.contentType;\n        }\n\n        if (status !== 0) {\n          state = 2;\n          that.readyState = 2;\n          that.status = status;\n          that.statusText = statusText;\n          that._contentType = contentType;\n          that.onreadystatechange();\n        }\n      }\n    };\n\n    var onProgress = function () {\n      onStart();\n\n      if (state === 2 || state === 3) {\n        state = 3;\n        var responseText = \"\";\n\n        try {\n          responseText = xhr.responseText;\n        } catch (error) {// IE 8 - 9 with XMLHttpRequest\n        }\n\n        that.readyState = 3;\n        that.responseText = responseText;\n        that.onprogress();\n      }\n    };\n\n    var onFinish = function (type, event) {\n      if (event == null || event.preventDefault == null) {\n        event = {\n          preventDefault: k\n        };\n      } // Firefox 52 fires \"readystatechange\" (xhr.readyState === 4) without final \"readystatechange\" (xhr.readyState === 3)\n      // IE 8 fires \"onload\" without \"onprogress\"\n\n\n      onProgress();\n\n      if (state === 1 || state === 2 || state === 3) {\n        state = 4;\n\n        if (timeout !== 0) {\n          clearTimeout(timeout);\n          timeout = 0;\n        }\n\n        that.readyState = 4;\n\n        if (type === \"load\") {\n          that.onload(event);\n        } else if (type === \"error\") {\n          that.onerror(event);\n        } else if (type === \"abort\") {\n          that.onabort(event);\n        } else {\n          throw new TypeError();\n        }\n\n        that.onreadystatechange();\n      }\n    };\n\n    var onReadyStateChange = function (event) {\n      if (xhr != undefined) {\n        // Opera 12\n        if (xhr.readyState === 4) {\n          if (!(\"onload\" in xhr) || !(\"onerror\" in xhr) || !(\"onabort\" in xhr)) {\n            onFinish(xhr.responseText === \"\" ? \"error\" : \"load\", event);\n          }\n        } else if (xhr.readyState === 3) {\n          if (!(\"onprogress\" in xhr)) {\n            // testing XMLHttpRequest#responseText too many times is too slow in IE 11\n            // and in Firefox 3.6\n            onProgress();\n          }\n        } else if (xhr.readyState === 2) {\n          onStart();\n        }\n      }\n    };\n\n    var onTimeout = function () {\n      timeout = setTimeout(function () {\n        onTimeout();\n      }, 500);\n\n      if (xhr.readyState === 3) {\n        onProgress();\n      }\n    }; // XDomainRequest#abort removes onprogress, onerror, onload\n\n\n    if (\"onload\" in xhr) {\n      xhr.onload = function (event) {\n        onFinish(\"load\", event);\n      };\n    }\n\n    if (\"onerror\" in xhr) {\n      xhr.onerror = function (event) {\n        onFinish(\"error\", event);\n      };\n    } // improper fix to match Firefox behaviour, but it is better than just ignore abort\n    // see https://bugzilla.mozilla.org/show_bug.cgi?id=768596\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=880200\n    // https://code.google.com/p/chromium/issues/detail?id=153570\n    // IE 8 fires \"onload\" without \"onprogress\n\n\n    if (\"onabort\" in xhr) {\n      xhr.onabort = function (event) {\n        onFinish(\"abort\", event);\n      };\n    }\n\n    if (\"onprogress\" in xhr) {\n      xhr.onprogress = onProgress;\n    } // IE 8 - 9 (XMLHTTPRequest)\n    // Opera < 12\n    // Firefox < 3.5\n    // Firefox 3.5 - 3.6 - ? < 9.0\n    // onprogress is not fired sometimes or delayed\n    // see also #64 (significant lag in IE 11)\n\n\n    if (\"onreadystatechange\" in xhr) {\n      xhr.onreadystatechange = function (event) {\n        onReadyStateChange(event);\n      };\n    }\n\n    if (\"contentType\" in xhr || !(\"ontimeout\" in XMLHttpRequest.prototype)) {\n      url += (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + \"padding=true\";\n    }\n\n    xhr.open(method, url, true);\n\n    if (\"readyState\" in xhr) {\n      // workaround for Opera 12 issue with \"progress\" events\n      // #91 (XMLHttpRequest onprogress not fired for streaming response in Edge 14-15-?)\n      timeout = setTimeout(function () {\n        onTimeout();\n      }, 0);\n    }\n  };\n\n  XHRWrapper.prototype.abort = function () {\n    this._abort(false);\n  };\n\n  XHRWrapper.prototype.getResponseHeader = function (name) {\n    return this._contentType;\n  };\n\n  XHRWrapper.prototype.setRequestHeader = function (name, value) {\n    var xhr = this._xhr;\n\n    if (\"setRequestHeader\" in xhr) {\n      xhr.setRequestHeader(name, value);\n    }\n  };\n\n  XHRWrapper.prototype.getAllResponseHeaders = function () {\n    // XMLHttpRequest#getAllResponseHeaders returns null for CORS requests in Firefox 3.6.28\n    return this._xhr.getAllResponseHeaders != undefined ? this._xhr.getAllResponseHeaders() || \"\" : \"\";\n  };\n\n  XHRWrapper.prototype.send = function () {\n    // loading indicator in Safari < ? (6), Chrome < 14, Firefox\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=736723\n    if ((!(\"ontimeout\" in XMLHttpRequest.prototype) || !(\"sendAsBinary\" in XMLHttpRequest.prototype) && !(\"mozAnon\" in XMLHttpRequest.prototype)) && document != undefined && document.readyState != undefined && document.readyState !== \"complete\") {\n      var that = this;\n      that._sendTimeout = setTimeout(function () {\n        that._sendTimeout = 0;\n        that.send();\n      }, 4);\n      return;\n    }\n\n    var xhr = this._xhr; // withCredentials should be set after \"open\" for Safari and Chrome (< 19 ?)\n\n    if (\"withCredentials\" in xhr) {\n      xhr.withCredentials = this.withCredentials;\n    }\n\n    try {\n      // xhr.send(); throws \"Not enough arguments\" in Firefox 3.0\n      xhr.send(undefined);\n    } catch (error1) {\n      // Safari 5.1.7, Opera 12\n      throw error1;\n    }\n  };\n\n  function toLowerCase(name) {\n    return name.replace(/[A-Z]/g, function (c) {\n      return String.fromCharCode(c.charCodeAt(0) + 0x20);\n    });\n  }\n\n  function HeadersPolyfill(all) {\n    // Get headers: implemented according to mozilla's example code: https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders#Example\n    var map = Object.create(null);\n    var array = all.split(\"\\r\\n\");\n\n    for (var i = 0; i < array.length; i += 1) {\n      var line = array[i];\n      var parts = line.split(\": \");\n      var name = parts.shift();\n      var value = parts.join(\": \");\n      map[toLowerCase(name)] = value;\n    }\n\n    this._map = map;\n  }\n\n  HeadersPolyfill.prototype.get = function (name) {\n    return this._map[toLowerCase(name)];\n  };\n\n  if (XMLHttpRequest != null && XMLHttpRequest.HEADERS_RECEIVED == null) {\n    // IE < 9, Firefox 3.6\n    XMLHttpRequest.HEADERS_RECEIVED = 2;\n  }\n\n  function XHRTransport() {}\n\n  XHRTransport.prototype.open = function (xhr, onStartCallback, onProgressCallback, onFinishCallback, url, withCredentials, headers) {\n    xhr.open(\"GET\", url);\n    var offset = 0;\n\n    xhr.onprogress = function () {\n      var responseText = xhr.responseText;\n      var chunk = responseText.slice(offset);\n      offset += chunk.length;\n      onProgressCallback(chunk);\n    };\n\n    xhr.onerror = function (event) {\n      event.preventDefault();\n      onFinishCallback(new Error(\"NetworkError\"));\n    };\n\n    xhr.onload = function () {\n      onFinishCallback(null);\n    };\n\n    xhr.onabort = function () {\n      onFinishCallback(null);\n    };\n\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === XMLHttpRequest.HEADERS_RECEIVED) {\n        var status = xhr.status;\n        var statusText = xhr.statusText;\n        var contentType = xhr.getResponseHeader(\"Content-Type\");\n        var headers = xhr.getAllResponseHeaders();\n        onStartCallback(status, statusText, contentType, new HeadersPolyfill(headers));\n      }\n    };\n\n    xhr.withCredentials = withCredentials;\n\n    for (var name in headers) {\n      if (Object.prototype.hasOwnProperty.call(headers, name)) {\n        xhr.setRequestHeader(name, headers[name]);\n      }\n    }\n\n    xhr.send();\n    return xhr;\n  };\n\n  function HeadersWrapper(headers) {\n    this._headers = headers;\n  }\n\n  HeadersWrapper.prototype.get = function (name) {\n    return this._headers.get(name);\n  };\n\n  function FetchTransport() {}\n\n  FetchTransport.prototype.open = function (xhr, onStartCallback, onProgressCallback, onFinishCallback, url, withCredentials, headers) {\n    var reader = null;\n    var controller = new AbortController();\n    var signal = controller.signal;\n    var textDecoder = new TextDecoder();\n    fetch(url, {\n      headers: headers,\n      credentials: withCredentials ? \"include\" : \"same-origin\",\n      signal: signal,\n      cache: \"no-store\"\n    }).then(function (response) {\n      reader = response.body.getReader();\n      onStartCallback(response.status, response.statusText, response.headers.get(\"Content-Type\"), new HeadersWrapper(response.headers)); // see https://github.com/promises-aplus/promises-spec/issues/179\n\n      return new Promise(function (resolve, reject) {\n        var readNextChunk = function () {\n          reader.read().then(function (result) {\n            if (result.done) {\n              //Note: bytes in textDecoder are ignored\n              resolve(undefined);\n            } else {\n              var chunk = textDecoder.decode(result.value, {\n                stream: true\n              });\n              onProgressCallback(chunk);\n              readNextChunk();\n            }\n          })[\"catch\"](function (error) {\n            reject(error);\n          });\n        };\n\n        readNextChunk();\n      });\n    })[\"catch\"](function (error) {\n      if (error.name === \"AbortError\") {\n        return undefined;\n      } else {\n        return error;\n      }\n    }).then(function (error) {\n      onFinishCallback(error);\n    });\n    return {\n      abort: function () {\n        if (reader != null) {\n          reader.cancel(); // https://bugzilla.mozilla.org/show_bug.cgi?id=1583815\n        }\n\n        controller.abort();\n      }\n    };\n  };\n\n  function EventTarget() {\n    this._listeners = Object.create(null);\n  }\n\n  function throwError(e) {\n    setTimeout(function () {\n      throw e;\n    }, 0);\n  }\n\n  EventTarget.prototype.dispatchEvent = function (event) {\n    event.target = this;\n    var typeListeners = this._listeners[event.type];\n\n    if (typeListeners != undefined) {\n      var length = typeListeners.length;\n\n      for (var i = 0; i < length; i += 1) {\n        var listener = typeListeners[i];\n\n        try {\n          if (typeof listener.handleEvent === \"function\") {\n            listener.handleEvent(event);\n          } else {\n            listener.call(this, event);\n          }\n        } catch (e) {\n          throwError(e);\n        }\n      }\n    }\n  };\n\n  EventTarget.prototype.addEventListener = function (type, listener) {\n    type = String(type);\n    var listeners = this._listeners;\n    var typeListeners = listeners[type];\n\n    if (typeListeners == undefined) {\n      typeListeners = [];\n      listeners[type] = typeListeners;\n    }\n\n    var found = false;\n\n    for (var i = 0; i < typeListeners.length; i += 1) {\n      if (typeListeners[i] === listener) {\n        found = true;\n      }\n    }\n\n    if (!found) {\n      typeListeners.push(listener);\n    }\n  };\n\n  EventTarget.prototype.removeEventListener = function (type, listener) {\n    type = String(type);\n    var listeners = this._listeners;\n    var typeListeners = listeners[type];\n\n    if (typeListeners != undefined) {\n      var filtered = [];\n\n      for (var i = 0; i < typeListeners.length; i += 1) {\n        if (typeListeners[i] !== listener) {\n          filtered.push(typeListeners[i]);\n        }\n      }\n\n      if (filtered.length === 0) {\n        delete listeners[type];\n      } else {\n        listeners[type] = filtered;\n      }\n    }\n  };\n\n  function Event(type) {\n    this.type = type;\n    this.target = undefined;\n  }\n\n  function MessageEvent(type, options) {\n    Event.call(this, type);\n    this.data = options.data;\n    this.lastEventId = options.lastEventId;\n  }\n\n  MessageEvent.prototype = Object.create(Event.prototype);\n\n  function ConnectionEvent(type, options) {\n    Event.call(this, type);\n    this.status = options.status;\n    this.statusText = options.statusText;\n    this.headers = options.headers;\n  }\n\n  ConnectionEvent.prototype = Object.create(Event.prototype);\n\n  function ErrorEvent(type, options) {\n    Event.call(this, type);\n    this.error = options.error;\n  }\n\n  ErrorEvent.prototype = Object.create(Event.prototype);\n  var WAITING = -1;\n  var CONNECTING = 0;\n  var OPEN = 1;\n  var CLOSED = 2;\n  var AFTER_CR = -1;\n  var FIELD_START = 0;\n  var FIELD = 1;\n  var VALUE_START = 2;\n  var VALUE = 3;\n  var contentTypeRegExp = /^text\\/event\\-stream(;.*)?$/i;\n  var MINIMUM_DURATION = 1000;\n  var MAXIMUM_DURATION = 18000000;\n\n  var parseDuration = function (value, def) {\n    var n = value == null ? def : parseInt(value, 10);\n\n    if (n !== n) {\n      n = def;\n    }\n\n    return clampDuration(n);\n  };\n\n  var clampDuration = function (n) {\n    return Math.min(Math.max(n, MINIMUM_DURATION), MAXIMUM_DURATION);\n  };\n\n  var fire = function (that, f, event) {\n    try {\n      if (typeof f === \"function\") {\n        f.call(that, event);\n      }\n    } catch (e) {\n      throwError(e);\n    }\n  };\n\n  function EventSourcePolyfill(url, options) {\n    EventTarget.call(this);\n    options = options || {};\n    this.onopen = undefined;\n    this.onmessage = undefined;\n    this.onerror = undefined;\n    this.url = undefined;\n    this.readyState = undefined;\n    this.withCredentials = undefined;\n    this.headers = undefined;\n    this._close = undefined;\n    start(this, url, options);\n  }\n\n  function getBestXHRTransport() {\n    return XMLHttpRequest != undefined && \"withCredentials\" in XMLHttpRequest.prototype || XDomainRequest == undefined ? new XMLHttpRequest() : new XDomainRequest();\n  }\n\n  var isFetchSupported = fetch != undefined && Response != undefined && \"body\" in Response.prototype;\n\n  function start(es, url, options) {\n    url = String(url);\n    var withCredentials = Boolean(options.withCredentials);\n    var lastEventIdQueryParameterName = options.lastEventIdQueryParameterName || \"lastEventId\";\n    var initialRetry = clampDuration(1000);\n    var heartbeatTimeout = parseDuration(options.heartbeatTimeout, 45000);\n    var lastEventId = \"\";\n    var retry = initialRetry;\n    var wasActivity = false;\n    var textLength = 0;\n    var headers = options.headers || {};\n    var TransportOption = options.Transport;\n    var xhr = isFetchSupported && TransportOption == undefined ? undefined : new XHRWrapper(TransportOption != undefined ? new TransportOption() : getBestXHRTransport());\n    var transport = TransportOption != null && typeof TransportOption !== \"string\" ? new TransportOption() : xhr == undefined ? new FetchTransport() : new XHRTransport();\n    var abortController = undefined;\n    var timeout = 0;\n    var currentState = WAITING;\n    var dataBuffer = \"\";\n    var lastEventIdBuffer = \"\";\n    var eventTypeBuffer = \"\";\n    var textBuffer = \"\";\n    var state = FIELD_START;\n    var fieldStart = 0;\n    var valueStart = 0;\n\n    var onStart = function (status, statusText, contentType, headers) {\n      if (currentState === CONNECTING) {\n        if (status === 200 && contentType != undefined && contentTypeRegExp.test(contentType)) {\n          currentState = OPEN;\n          wasActivity = Date.now();\n          retry = initialRetry;\n          es.readyState = OPEN;\n          var event = new ConnectionEvent(\"open\", {\n            status: status,\n            statusText: statusText,\n            headers: headers\n          });\n          es.dispatchEvent(event);\n          fire(es, es.onopen, event);\n        } else {\n          var message = \"\";\n\n          if (status !== 200) {\n            if (statusText) {\n              statusText = statusText.replace(/\\s+/g, \" \");\n            }\n\n            message = \"EventSource's response has a status \" + status + \" \" + statusText + \" that is not 200. Aborting the connection.\";\n          } else {\n            message = \"EventSource's response has a Content-Type specifying an unsupported type: \" + (contentType == undefined ? \"-\" : contentType.replace(/\\s+/g, \" \")) + \". Aborting the connection.\";\n          }\n\n          close();\n          var event = new ConnectionEvent(\"error\", {\n            status: status,\n            statusText: statusText,\n            headers: headers\n          });\n          es.dispatchEvent(event);\n          fire(es, es.onerror, event);\n          console.error(message);\n        }\n      }\n    };\n\n    var onProgress = function (textChunk) {\n      if (currentState === OPEN) {\n        var n = -1;\n\n        for (var i = 0; i < textChunk.length; i += 1) {\n          var c = textChunk.charCodeAt(i);\n\n          if (c === \"\\n\".charCodeAt(0) || c === \"\\r\".charCodeAt(0)) {\n            n = i;\n          }\n        }\n\n        var chunk = (n !== -1 ? textBuffer : \"\") + textChunk.slice(0, n + 1);\n        textBuffer = (n === -1 ? textBuffer : \"\") + textChunk.slice(n + 1);\n\n        if (textChunk !== \"\") {\n          wasActivity = Date.now();\n          textLength += textChunk.length;\n        }\n\n        for (var position = 0; position < chunk.length; position += 1) {\n          var c = chunk.charCodeAt(position);\n\n          if (state === AFTER_CR && c === \"\\n\".charCodeAt(0)) {\n            state = FIELD_START;\n          } else {\n            if (state === AFTER_CR) {\n              state = FIELD_START;\n            }\n\n            if (c === \"\\r\".charCodeAt(0) || c === \"\\n\".charCodeAt(0)) {\n              if (state !== FIELD_START) {\n                if (state === FIELD) {\n                  valueStart = position + 1;\n                }\n\n                var field = chunk.slice(fieldStart, valueStart - 1);\n                var value = chunk.slice(valueStart + (valueStart < position && chunk.charCodeAt(valueStart) === \" \".charCodeAt(0) ? 1 : 0), position);\n\n                if (field === \"data\") {\n                  dataBuffer += \"\\n\";\n                  dataBuffer += value;\n                } else if (field === \"id\") {\n                  lastEventIdBuffer = value;\n                } else if (field === \"event\") {\n                  eventTypeBuffer = value;\n                } else if (field === \"retry\") {\n                  initialRetry = parseDuration(value, initialRetry);\n                  retry = initialRetry;\n                } else if (field === \"heartbeatTimeout\") {\n                  heartbeatTimeout = parseDuration(value, heartbeatTimeout);\n\n                  if (timeout !== 0) {\n                    clearTimeout(timeout);\n                    timeout = setTimeout(function () {\n                      onTimeout();\n                    }, heartbeatTimeout);\n                  }\n                }\n              }\n\n              if (state === FIELD_START) {\n                if (dataBuffer !== \"\") {\n                  lastEventId = lastEventIdBuffer;\n\n                  if (eventTypeBuffer === \"\") {\n                    eventTypeBuffer = \"message\";\n                  }\n\n                  var event = new MessageEvent(eventTypeBuffer, {\n                    data: dataBuffer.slice(1),\n                    lastEventId: lastEventIdBuffer\n                  });\n                  es.dispatchEvent(event);\n\n                  if (eventTypeBuffer === \"open\") {\n                    fire(es, es.onopen, event);\n                  } else if (eventTypeBuffer === \"message\") {\n                    fire(es, es.onmessage, event);\n                  } else if (eventTypeBuffer === \"error\") {\n                    fire(es, es.onerror, event);\n                  }\n\n                  if (currentState === CLOSED) {\n                    return;\n                  }\n                }\n\n                dataBuffer = \"\";\n                eventTypeBuffer = \"\";\n              }\n\n              state = c === \"\\r\".charCodeAt(0) ? AFTER_CR : FIELD_START;\n            } else {\n              if (state === FIELD_START) {\n                fieldStart = position;\n                state = FIELD;\n              }\n\n              if (state === FIELD) {\n                if (c === \":\".charCodeAt(0)) {\n                  valueStart = position + 1;\n                  state = VALUE_START;\n                }\n              } else if (state === VALUE_START) {\n                state = VALUE;\n              }\n            }\n          }\n        }\n      }\n    };\n\n    var onFinish = function (error) {\n      if (currentState === OPEN || currentState === CONNECTING) {\n        currentState = WAITING;\n\n        if (timeout !== 0) {\n          clearTimeout(timeout);\n          timeout = 0;\n        }\n\n        timeout = setTimeout(function () {\n          onTimeout();\n        }, retry);\n        retry = clampDuration(Math.min(initialRetry * 16, retry * 2));\n        es.readyState = CONNECTING;\n        var event = new ErrorEvent(\"error\", {\n          error: error\n        });\n        es.dispatchEvent(event);\n        fire(es, es.onerror, event);\n\n        if (error != undefined) {\n          console.error(error);\n        }\n      }\n    };\n\n    var close = function () {\n      currentState = CLOSED;\n\n      if (abortController != undefined) {\n        abortController.abort();\n        abortController = undefined;\n      }\n\n      if (timeout !== 0) {\n        clearTimeout(timeout);\n        timeout = 0;\n      }\n\n      es.readyState = CLOSED;\n    };\n\n    var onTimeout = function () {\n      timeout = 0;\n\n      if (currentState !== WAITING) {\n        if (!wasActivity && abortController != undefined) {\n          onFinish(new Error(\"No activity within \" + heartbeatTimeout + \" milliseconds.\" + \" \" + (currentState === CONNECTING ? \"No response received.\" : textLength + \" chars received.\") + \" \" + \"Reconnecting.\"));\n\n          if (abortController != undefined) {\n            abortController.abort();\n            abortController = undefined;\n          }\n        } else {\n          var nextHeartbeat = Math.max((wasActivity || Date.now()) + heartbeatTimeout - Date.now(), 1);\n          wasActivity = false;\n          timeout = setTimeout(function () {\n            onTimeout();\n          }, nextHeartbeat);\n        }\n\n        return;\n      }\n\n      wasActivity = false;\n      textLength = 0;\n      timeout = setTimeout(function () {\n        onTimeout();\n      }, heartbeatTimeout);\n      currentState = CONNECTING;\n      dataBuffer = \"\";\n      eventTypeBuffer = \"\";\n      lastEventIdBuffer = lastEventId;\n      textBuffer = \"\";\n      fieldStart = 0;\n      valueStart = 0;\n      state = FIELD_START; // https://bugzilla.mozilla.org/show_bug.cgi?id=428916\n      // Request header field Last-Event-ID is not allowed by Access-Control-Allow-Headers.\n\n      var requestURL = url;\n\n      if (url.slice(0, 5) !== \"data:\" && url.slice(0, 5) !== \"blob:\") {\n        if (lastEventId !== \"\") {\n          // Remove the lastEventId parameter if it's already part of the request URL.\n          var i = url.indexOf(\"?\");\n          requestURL = i === -1 ? url : url.slice(0, i + 1) + url.slice(i + 1).replace(/(?:^|&)([^=&]*)(?:=[^&]*)?/g, function (p, paramName) {\n            return paramName === lastEventIdQueryParameterName ? '' : p;\n          }); // Append the current lastEventId to the request URL.\n\n          requestURL += (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + lastEventIdQueryParameterName + \"=\" + encodeURIComponent(lastEventId);\n        }\n      }\n\n      var withCredentials = es.withCredentials;\n      var requestHeaders = {};\n      requestHeaders[\"Accept\"] = \"text/event-stream\";\n      var headers = es.headers;\n\n      if (headers != undefined) {\n        for (var name in headers) {\n          if (Object.prototype.hasOwnProperty.call(headers, name)) {\n            requestHeaders[name] = headers[name];\n          }\n        }\n      }\n\n      try {\n        abortController = transport.open(xhr, onStart, onProgress, onFinish, requestURL, withCredentials, requestHeaders);\n      } catch (error) {\n        close();\n        throw error;\n      }\n    };\n\n    es.url = url;\n    es.readyState = CONNECTING;\n    es.withCredentials = withCredentials;\n    es.headers = headers;\n    es._close = close;\n    onTimeout();\n  }\n\n  EventSourcePolyfill.prototype = Object.create(EventTarget.prototype);\n  EventSourcePolyfill.prototype.CONNECTING = CONNECTING;\n  EventSourcePolyfill.prototype.OPEN = OPEN;\n  EventSourcePolyfill.prototype.CLOSED = CLOSED;\n\n  EventSourcePolyfill.prototype.close = function () {\n    this._close();\n  };\n\n  EventSourcePolyfill.CONNECTING = CONNECTING;\n  EventSourcePolyfill.OPEN = OPEN;\n  EventSourcePolyfill.CLOSED = CLOSED;\n  EventSourcePolyfill.prototype.withCredentials = undefined;\n  var R = NativeEventSource;\n\n  if (XMLHttpRequest != undefined && (NativeEventSource == undefined || !(\"withCredentials\" in NativeEventSource.prototype))) {\n    // Why replace a native EventSource ?\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=444328\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=831392\n    // https://code.google.com/p/chromium/issues/detail?id=260144\n    // https://code.google.com/p/chromium/issues/detail?id=225654\n    // ...\n    R = EventSourcePolyfill;\n  }\n\n  (function (factory) {\n    if (typeof module === \"object\" && typeof module.exports === \"object\") {\n      var v = factory(exports);\n      if (v !== undefined) module.exports = v;\n    } else if (typeof define === \"function\" && define.amd) {\n      define([\"exports\"], factory);\n    } else {\n      factory(global);\n    }\n  })(function (exports) {\n    exports.EventSourcePolyfill = EventSourcePolyfill;\n    exports.NativeEventSource = NativeEventSource;\n    exports.EventSource = R;\n  });\n})(typeof globalThis === 'undefined' ? typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : this : globalThis);","map":{"version":3,"sources":["/home/mcleanj/projects/portfolio-website/portfolio-website-frontend/node_modules/event-source-polyfill/src/eventsource.js"],"names":["global","setTimeout","clearTimeout","XMLHttpRequest","XDomainRequest","ActiveXObject","NativeEventSource","EventSource","document","Promise","fetch","Response","TextDecoder","TextEncoder","AbortController","window","body","readyState","addEventListener","event","Object","create","undefined","C","F","prototype","Date","now","getTime","originalFetch2","url","options","signal","headers","credentials","cache","then","response","reader","getReader","_reader","_aborted","cancel","status","statusText","abort","TextDecoderPolyfill","bitsNeeded","codePoint","decode","octets","valid","shift","octetsCount","Error","REPLACER","string","i","length","octet","String","fromCharCode","supportsStreamOption","encode","stream","error","console","debug","k","XHRWrapper","xhr","withCredentials","responseText","onprogress","onload","onerror","onreadystatechange","_contentType","_xhr","_sendTimeout","_abort","open","method","that","state","timeout","silent","onabort","onStart","contentType","getResponseHeader","onProgress","onFinish","type","preventDefault","TypeError","onReadyStateChange","onTimeout","indexOf","name","setRequestHeader","value","getAllResponseHeaders","send","error1","toLowerCase","replace","c","charCodeAt","HeadersPolyfill","all","map","array","split","line","parts","join","_map","get","HEADERS_RECEIVED","XHRTransport","onStartCallback","onProgressCallback","onFinishCallback","offset","chunk","slice","hasOwnProperty","call","HeadersWrapper","_headers","FetchTransport","controller","textDecoder","resolve","reject","readNextChunk","read","result","done","EventTarget","_listeners","throwError","e","dispatchEvent","target","typeListeners","listener","handleEvent","listeners","found","push","removeEventListener","filtered","Event","MessageEvent","data","lastEventId","ConnectionEvent","ErrorEvent","WAITING","CONNECTING","OPEN","CLOSED","AFTER_CR","FIELD_START","FIELD","VALUE_START","VALUE","contentTypeRegExp","MINIMUM_DURATION","MAXIMUM_DURATION","parseDuration","def","n","parseInt","clampDuration","Math","min","max","fire","f","EventSourcePolyfill","onopen","onmessage","_close","start","getBestXHRTransport","isFetchSupported","es","Boolean","lastEventIdQueryParameterName","initialRetry","heartbeatTimeout","retry","wasActivity","textLength","TransportOption","Transport","transport","abortController","currentState","dataBuffer","lastEventIdBuffer","eventTypeBuffer","textBuffer","fieldStart","valueStart","test","message","close","textChunk","position","field","nextHeartbeat","requestURL","p","paramName","encodeURIComponent","requestHeaders","R","factory","module","exports","v","define","amd","globalThis","self"],"mappings":"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","sourcesContent":["/** @license\r\n * eventsource.js\r\n * Available under MIT License (MIT)\r\n * https://github.com/Yaffle/EventSource/\r\n */\r\n\r\n/*jslint indent: 2, vars: true, plusplus: true */\r\n/*global setTimeout, clearTimeout */\r\n\r\n(function (global) {\r\n  \"use strict\";\r\n\r\n  var setTimeout = global.setTimeout;\r\n  var clearTimeout = global.clearTimeout;\r\n  var XMLHttpRequest = global.XMLHttpRequest;\r\n  var XDomainRequest = global.XDomainRequest;\r\n  var ActiveXObject = global.ActiveXObject;\r\n  var NativeEventSource = global.EventSource;\r\n\r\n  var document = global.document;\r\n  var Promise = global.Promise;\r\n  var fetch = global.fetch;\r\n  var Response = global.Response;\r\n  var TextDecoder = global.TextDecoder;\r\n  var TextEncoder = global.TextEncoder;\r\n  var AbortController = global.AbortController;\r\n\r\n  if (typeof window !== \"undefined\" && typeof document !== \"undefined\" && !(\"readyState\" in document) && document.body == null) { // Firefox 2\r\n    document.readyState = \"loading\";\r\n    window.addEventListener(\"load\", function (event) {\r\n      document.readyState = \"complete\";\r\n    }, false);\r\n  }\r\n\r\n  if (XMLHttpRequest == null && ActiveXObject != null) { // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest_in_IE6\r\n    XMLHttpRequest = function () {\r\n      return new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    };\r\n  }\r\n\r\n  if (Object.create == undefined) {\r\n    Object.create = function (C) {\r\n      function F(){}\r\n      F.prototype = C;\r\n      return new F();\r\n    };\r\n  }\r\n\r\n  if (!Date.now) {\r\n    Date.now = function now() {\r\n      return new Date().getTime();\r\n    };\r\n  }\r\n\r\n  // see #118 (Promise#finally with polyfilled Promise)\r\n  // see #123 (data URLs crash Edge)\r\n  // see #125 (CSP violations)\r\n  // see pull/#138\r\n  // => No way to polyfill Promise#finally\r\n\r\n  if (AbortController == undefined) {\r\n    var originalFetch2 = fetch;\r\n    fetch = function (url, options) {\r\n      var signal = options.signal;\r\n      return originalFetch2(url, {headers: options.headers, credentials: options.credentials, cache: options.cache}).then(function (response) {\r\n        var reader = response.body.getReader();\r\n        signal._reader = reader;\r\n        if (signal._aborted) {\r\n          signal._reader.cancel();\r\n        }\r\n        return {\r\n          status: response.status,\r\n          statusText: response.statusText,\r\n          headers: response.headers,\r\n          body: {\r\n            getReader: function () {\r\n              return reader;\r\n            }\r\n          }\r\n        };\r\n      });\r\n    };\r\n    AbortController = function () {\r\n      this.signal = {\r\n        _reader: null,\r\n        _aborted: false\r\n      };\r\n      this.abort = function () {\r\n        if (this.signal._reader != null) {\r\n          this.signal._reader.cancel();\r\n        }\r\n        this.signal._aborted = true;\r\n      };\r\n    };\r\n  }\r\n\r\n  function TextDecoderPolyfill() {\r\n    this.bitsNeeded = 0;\r\n    this.codePoint = 0;\r\n  }\r\n\r\n  TextDecoderPolyfill.prototype.decode = function (octets) {\r\n    function valid(codePoint, shift, octetsCount) {\r\n      if (octetsCount === 1) {\r\n        return codePoint >= 0x0080 >> shift && codePoint << shift <= 0x07FF;\r\n      }\r\n      if (octetsCount === 2) {\r\n        return codePoint >= 0x0800 >> shift && codePoint << shift <= 0xD7FF || codePoint >= 0xE000 >> shift && codePoint << shift <= 0xFFFF;\r\n      }\r\n      if (octetsCount === 3) {\r\n        return codePoint >= 0x010000 >> shift && codePoint << shift <= 0x10FFFF;\r\n      }\r\n      throw new Error();\r\n    }\r\n    function octetsCount(bitsNeeded, codePoint) {\r\n      if (bitsNeeded === 6 * 1) {\r\n        return codePoint >> 6 > 15 ? 3 : codePoint > 31 ? 2 : 1;\r\n      }\r\n      if (bitsNeeded === 6 * 2) {\r\n        return codePoint > 15 ? 3 : 2;\r\n      }\r\n      if (bitsNeeded === 6 * 3) {\r\n        return 3;\r\n      }\r\n      throw new Error();\r\n    }\r\n    var REPLACER = 0xFFFD;\r\n    var string = \"\";\r\n    var bitsNeeded = this.bitsNeeded;\r\n    var codePoint = this.codePoint;\r\n    for (var i = 0; i < octets.length; i += 1) {\r\n      var octet = octets[i];\r\n      if (bitsNeeded !== 0) {\r\n        if (octet < 128 || octet > 191 || !valid(codePoint << 6 | octet & 63, bitsNeeded - 6, octetsCount(bitsNeeded, codePoint))) {\r\n          bitsNeeded = 0;\r\n          codePoint = REPLACER;\r\n          string += String.fromCharCode(codePoint);\r\n        }\r\n      }\r\n      if (bitsNeeded === 0) {\r\n        if (octet >= 0 && octet <= 127) {\r\n          bitsNeeded = 0;\r\n          codePoint = octet;\r\n        } else if (octet >= 192 && octet <= 223) {\r\n          bitsNeeded = 6 * 1;\r\n          codePoint = octet & 31;\r\n        } else if (octet >= 224 && octet <= 239) {\r\n          bitsNeeded = 6 * 2;\r\n          codePoint = octet & 15;\r\n        } else if (octet >= 240 && octet <= 247) {\r\n          bitsNeeded = 6 * 3;\r\n          codePoint = octet & 7;\r\n        } else {\r\n          bitsNeeded = 0;\r\n          codePoint = REPLACER;\r\n        }\r\n        if (bitsNeeded !== 0 && !valid(codePoint, bitsNeeded, octetsCount(bitsNeeded, codePoint))) {\r\n          bitsNeeded = 0;\r\n          codePoint = REPLACER;\r\n        }\r\n      } else {\r\n        bitsNeeded -= 6;\r\n        codePoint = codePoint << 6 | octet & 63;\r\n      }\r\n      if (bitsNeeded === 0) {\r\n        if (codePoint <= 0xFFFF) {\r\n          string += String.fromCharCode(codePoint);\r\n        } else {\r\n          string += String.fromCharCode(0xD800 + (codePoint - 0xFFFF - 1 >> 10));\r\n          string += String.fromCharCode(0xDC00 + (codePoint - 0xFFFF - 1 & 0x3FF));\r\n        }\r\n      }\r\n    }\r\n    this.bitsNeeded = bitsNeeded;\r\n    this.codePoint = codePoint;\r\n    return string;\r\n  };\r\n\r\n  // Firefox < 38 throws an error with stream option\r\n  var supportsStreamOption = function () {\r\n    try {\r\n      return new TextDecoder().decode(new TextEncoder().encode(\"test\"), {stream: true}) === \"test\";\r\n    } catch (error) {\r\n      console.debug(\"TextDecoder does not support streaming option. Using polyfill instead: \" + error);\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // IE, Edge\r\n  if (TextDecoder == undefined || TextEncoder == undefined || !supportsStreamOption()) {\r\n    TextDecoder = TextDecoderPolyfill;\r\n  }\r\n\r\n  var k = function () {\r\n  };\r\n\r\n  function XHRWrapper(xhr) {\r\n    this.withCredentials = false;\r\n    this.readyState = 0;\r\n    this.status = 0;\r\n    this.statusText = \"\";\r\n    this.responseText = \"\";\r\n    this.onprogress = k;\r\n    this.onload = k;\r\n    this.onerror = k;\r\n    this.onreadystatechange = k;\r\n    this._contentType = \"\";\r\n    this._xhr = xhr;\r\n    this._sendTimeout = 0;\r\n    this._abort = k;\r\n  }\r\n\r\n  XHRWrapper.prototype.open = function (method, url) {\r\n    this._abort(true);\r\n\r\n    var that = this;\r\n    var xhr = this._xhr;\r\n    var state = 1;\r\n    var timeout = 0;\r\n\r\n    this._abort = function (silent) {\r\n      if (that._sendTimeout !== 0) {\r\n        clearTimeout(that._sendTimeout);\r\n        that._sendTimeout = 0;\r\n      }\r\n      if (state === 1 || state === 2 || state === 3) {\r\n        state = 4;\r\n        xhr.onload = k;\r\n        xhr.onerror = k;\r\n        xhr.onabort = k;\r\n        xhr.onprogress = k;\r\n        xhr.onreadystatechange = k;\r\n        // IE 8 - 9: XDomainRequest#abort() does not fire any event\r\n        // Opera < 10: XMLHttpRequest#abort() does not fire any event\r\n        xhr.abort();\r\n        if (timeout !== 0) {\r\n          clearTimeout(timeout);\r\n          timeout = 0;\r\n        }\r\n        if (!silent) {\r\n          that.readyState = 4;\r\n          that.onabort(null);\r\n          that.onreadystatechange();\r\n        }\r\n      }\r\n      state = 0;\r\n    };\r\n\r\n    var onStart = function () {\r\n      if (state === 1) {\r\n        //state = 2;\r\n        var status = 0;\r\n        var statusText = \"\";\r\n        var contentType = undefined;\r\n        if (!(\"contentType\" in xhr)) {\r\n          try {\r\n            status = xhr.status;\r\n            statusText = xhr.statusText;\r\n            contentType = xhr.getResponseHeader(\"Content-Type\");\r\n          } catch (error) {\r\n            // IE < 10 throws exception for `xhr.status` when xhr.readyState === 2 || xhr.readyState === 3\r\n            // Opera < 11 throws exception for `xhr.status` when xhr.readyState === 2\r\n            // https://bugs.webkit.org/show_bug.cgi?id=29121\r\n            status = 0;\r\n            statusText = \"\";\r\n            contentType = undefined;\r\n            // Firefox < 14, Chrome ?, Safari ?\r\n            // https://bugs.webkit.org/show_bug.cgi?id=29658\r\n            // https://bugs.webkit.org/show_bug.cgi?id=77854\r\n          }\r\n        } else {\r\n          status = 200;\r\n          statusText = \"OK\";\r\n          contentType = xhr.contentType;\r\n        }\r\n        if (status !== 0) {\r\n          state = 2;\r\n          that.readyState = 2;\r\n          that.status = status;\r\n          that.statusText = statusText;\r\n          that._contentType = contentType;\r\n          that.onreadystatechange();\r\n        }\r\n      }\r\n    };\r\n    var onProgress = function () {\r\n      onStart();\r\n      if (state === 2 || state === 3) {\r\n        state = 3;\r\n        var responseText = \"\";\r\n        try {\r\n          responseText = xhr.responseText;\r\n        } catch (error) {\r\n          // IE 8 - 9 with XMLHttpRequest\r\n        }\r\n        that.readyState = 3;\r\n        that.responseText = responseText;\r\n        that.onprogress();\r\n      }\r\n    };\r\n    var onFinish = function (type, event) {\r\n      if (event == null || event.preventDefault == null) {\r\n        event = {\r\n          preventDefault: k\r\n        };\r\n      }\r\n      // Firefox 52 fires \"readystatechange\" (xhr.readyState === 4) without final \"readystatechange\" (xhr.readyState === 3)\r\n      // IE 8 fires \"onload\" without \"onprogress\"\r\n      onProgress();\r\n      if (state === 1 || state === 2 || state === 3) {\r\n        state = 4;\r\n        if (timeout !== 0) {\r\n          clearTimeout(timeout);\r\n          timeout = 0;\r\n        }\r\n        that.readyState = 4;\r\n        if (type === \"load\") {\r\n          that.onload(event);\r\n        } else if (type === \"error\") {\r\n          that.onerror(event);\r\n        } else if (type === \"abort\") {\r\n          that.onabort(event);\r\n        } else {\r\n          throw new TypeError();\r\n        }\r\n        that.onreadystatechange();\r\n      }\r\n    };\r\n    var onReadyStateChange = function (event) {\r\n      if (xhr != undefined) { // Opera 12\r\n        if (xhr.readyState === 4) {\r\n          if (!(\"onload\" in xhr) || !(\"onerror\" in xhr) || !(\"onabort\" in xhr)) {\r\n            onFinish(xhr.responseText === \"\" ? \"error\" : \"load\", event);\r\n          }\r\n        } else if (xhr.readyState === 3) {\r\n          if (!(\"onprogress\" in xhr)) { // testing XMLHttpRequest#responseText too many times is too slow in IE 11\r\n            // and in Firefox 3.6\r\n            onProgress();\r\n          }\r\n        } else if (xhr.readyState === 2) {\r\n          onStart();\r\n        }\r\n      }\r\n    };\r\n    var onTimeout = function () {\r\n      timeout = setTimeout(function () {\r\n        onTimeout();\r\n      }, 500);\r\n      if (xhr.readyState === 3) {\r\n        onProgress();\r\n      }\r\n    };\r\n\r\n    // XDomainRequest#abort removes onprogress, onerror, onload\r\n    if (\"onload\" in xhr) {\r\n      xhr.onload = function (event) {\r\n        onFinish(\"load\", event);\r\n      };\r\n    }\r\n    if (\"onerror\" in xhr) {\r\n      xhr.onerror = function (event) {\r\n        onFinish(\"error\", event);\r\n      };\r\n    }\r\n    // improper fix to match Firefox behaviour, but it is better than just ignore abort\r\n    // see https://bugzilla.mozilla.org/show_bug.cgi?id=768596\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=880200\r\n    // https://code.google.com/p/chromium/issues/detail?id=153570\r\n    // IE 8 fires \"onload\" without \"onprogress\r\n    if (\"onabort\" in xhr) {\r\n      xhr.onabort = function (event) {\r\n        onFinish(\"abort\", event);\r\n      };\r\n    }\r\n\r\n    if (\"onprogress\" in xhr) {\r\n      xhr.onprogress = onProgress;\r\n    }\r\n\r\n    // IE 8 - 9 (XMLHTTPRequest)\r\n    // Opera < 12\r\n    // Firefox < 3.5\r\n    // Firefox 3.5 - 3.6 - ? < 9.0\r\n    // onprogress is not fired sometimes or delayed\r\n    // see also #64 (significant lag in IE 11)\r\n    if (\"onreadystatechange\" in xhr) {\r\n      xhr.onreadystatechange = function (event) {\r\n        onReadyStateChange(event);\r\n      };\r\n    }\r\n\r\n    if (\"contentType\" in xhr || !(\"ontimeout\" in XMLHttpRequest.prototype)) {\r\n      url += (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + \"padding=true\";\r\n    }\r\n    xhr.open(method, url, true);\r\n\r\n    if (\"readyState\" in xhr) {\r\n      // workaround for Opera 12 issue with \"progress\" events\r\n      // #91 (XMLHttpRequest onprogress not fired for streaming response in Edge 14-15-?)\r\n      timeout = setTimeout(function () {\r\n        onTimeout();\r\n      }, 0);\r\n    }\r\n  };\r\n  XHRWrapper.prototype.abort = function () {\r\n    this._abort(false);\r\n  };\r\n  XHRWrapper.prototype.getResponseHeader = function (name) {\r\n    return this._contentType;\r\n  };\r\n  XHRWrapper.prototype.setRequestHeader = function (name, value) {\r\n    var xhr = this._xhr;\r\n    if (\"setRequestHeader\" in xhr) {\r\n      xhr.setRequestHeader(name, value);\r\n    }\r\n  };\r\n  XHRWrapper.prototype.getAllResponseHeaders = function () {\r\n    // XMLHttpRequest#getAllResponseHeaders returns null for CORS requests in Firefox 3.6.28\r\n    return this._xhr.getAllResponseHeaders != undefined ? this._xhr.getAllResponseHeaders() || \"\" : \"\";\r\n  };\r\n  XHRWrapper.prototype.send = function () {\r\n    // loading indicator in Safari < ? (6), Chrome < 14, Firefox\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=736723\r\n    if ((!(\"ontimeout\" in XMLHttpRequest.prototype) || (!(\"sendAsBinary\" in XMLHttpRequest.prototype) && !(\"mozAnon\" in XMLHttpRequest.prototype))) &&\r\n        document != undefined &&\r\n        document.readyState != undefined &&\r\n        document.readyState !== \"complete\") {\r\n      var that = this;\r\n      that._sendTimeout = setTimeout(function () {\r\n        that._sendTimeout = 0;\r\n        that.send();\r\n      }, 4);\r\n      return;\r\n    }\r\n\r\n    var xhr = this._xhr;\r\n    // withCredentials should be set after \"open\" for Safari and Chrome (< 19 ?)\r\n    if (\"withCredentials\" in xhr) {\r\n      xhr.withCredentials = this.withCredentials;\r\n    }\r\n    try {\r\n      // xhr.send(); throws \"Not enough arguments\" in Firefox 3.0\r\n      xhr.send(undefined);\r\n    } catch (error1) {\r\n      // Safari 5.1.7, Opera 12\r\n      throw error1;\r\n    }\r\n  };\r\n\r\n  function toLowerCase(name) {\r\n    return name.replace(/[A-Z]/g, function (c) {\r\n      return String.fromCharCode(c.charCodeAt(0) + 0x20);\r\n    });\r\n  }\r\n\r\n  function HeadersPolyfill(all) {\r\n    // Get headers: implemented according to mozilla's example code: https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders#Example\r\n    var map = Object.create(null);\r\n    var array = all.split(\"\\r\\n\");\r\n    for (var i = 0; i < array.length; i += 1) {\r\n      var line = array[i];\r\n      var parts = line.split(\": \");\r\n      var name = parts.shift();\r\n      var value = parts.join(\": \");\r\n      map[toLowerCase(name)] = value;\r\n    }\r\n    this._map = map;\r\n  }\r\n  HeadersPolyfill.prototype.get = function (name) {\r\n    return this._map[toLowerCase(name)];\r\n  };\r\n\r\n  if (XMLHttpRequest != null && XMLHttpRequest.HEADERS_RECEIVED == null) { // IE < 9, Firefox 3.6\r\n    XMLHttpRequest.HEADERS_RECEIVED = 2;\r\n  }\r\n\r\n  function XHRTransport() {\r\n  }\r\n\r\n  XHRTransport.prototype.open = function (xhr, onStartCallback, onProgressCallback, onFinishCallback, url, withCredentials, headers) {\r\n    xhr.open(\"GET\", url);\r\n    var offset = 0;\r\n    xhr.onprogress = function () {\r\n      var responseText = xhr.responseText;\r\n      var chunk = responseText.slice(offset);\r\n      offset += chunk.length;\r\n      onProgressCallback(chunk);\r\n    };\r\n    xhr.onerror = function (event) {\r\n      event.preventDefault();\r\n      onFinishCallback(new Error(\"NetworkError\"));\r\n    };\r\n    xhr.onload = function () {\r\n      onFinishCallback(null);\r\n    };\r\n    xhr.onabort = function () {\r\n      onFinishCallback(null);\r\n    };\r\n    xhr.onreadystatechange = function () {\r\n      if (xhr.readyState === XMLHttpRequest.HEADERS_RECEIVED) {\r\n        var status = xhr.status;\r\n        var statusText = xhr.statusText;\r\n        var contentType = xhr.getResponseHeader(\"Content-Type\");\r\n        var headers = xhr.getAllResponseHeaders();\r\n        onStartCallback(status, statusText, contentType, new HeadersPolyfill(headers));\r\n      }\r\n    };\r\n    xhr.withCredentials = withCredentials;\r\n    for (var name in headers) {\r\n      if (Object.prototype.hasOwnProperty.call(headers, name)) {\r\n        xhr.setRequestHeader(name, headers[name]);\r\n      }\r\n    }\r\n    xhr.send();\r\n    return xhr;\r\n  };\r\n\r\n  function HeadersWrapper(headers) {\r\n    this._headers = headers;\r\n  }\r\n  HeadersWrapper.prototype.get = function (name) {\r\n    return this._headers.get(name);\r\n  };\r\n\r\n  function FetchTransport() {\r\n  }\r\n\r\n  FetchTransport.prototype.open = function (xhr, onStartCallback, onProgressCallback, onFinishCallback, url, withCredentials, headers) {\r\n    var reader = null;\r\n    var controller = new AbortController();\r\n    var signal = controller.signal;\r\n    var textDecoder = new TextDecoder();\r\n    fetch(url, {\r\n      headers: headers,\r\n      credentials: withCredentials ? \"include\" : \"same-origin\",\r\n      signal: signal,\r\n      cache: \"no-store\"\r\n    }).then(function (response) {\r\n      reader = response.body.getReader();\r\n      onStartCallback(response.status, response.statusText, response.headers.get(\"Content-Type\"), new HeadersWrapper(response.headers));\r\n      // see https://github.com/promises-aplus/promises-spec/issues/179\r\n      return new Promise(function (resolve, reject) {\r\n        var readNextChunk = function () {\r\n          reader.read().then(function (result) {\r\n            if (result.done) {\r\n              //Note: bytes in textDecoder are ignored\r\n              resolve(undefined);\r\n            } else {\r\n              var chunk = textDecoder.decode(result.value, {stream: true});\r\n              onProgressCallback(chunk);\r\n              readNextChunk();\r\n            }\r\n          })[\"catch\"](function (error) {\r\n            reject(error);\r\n          });\r\n        };\r\n        readNextChunk();\r\n      });\r\n    })[\"catch\"](function (error) {\r\n      if (error.name === \"AbortError\") {\r\n        return undefined;\r\n      } else {\r\n        return error;\r\n      }\r\n    }).then(function (error) {\r\n      onFinishCallback(error);\r\n    });\r\n    return {\r\n      abort: function () {\r\n        if (reader != null) {\r\n          reader.cancel(); // https://bugzilla.mozilla.org/show_bug.cgi?id=1583815\r\n        }\r\n        controller.abort();\r\n      }\r\n    };\r\n  };\r\n\r\n  function EventTarget() {\r\n    this._listeners = Object.create(null);\r\n  }\r\n\r\n  function throwError(e) {\r\n    setTimeout(function () {\r\n      throw e;\r\n    }, 0);\r\n  }\r\n\r\n  EventTarget.prototype.dispatchEvent = function (event) {\r\n    event.target = this;\r\n    var typeListeners = this._listeners[event.type];\r\n    if (typeListeners != undefined) {\r\n      var length = typeListeners.length;\r\n      for (var i = 0; i < length; i += 1) {\r\n        var listener = typeListeners[i];\r\n        try {\r\n          if (typeof listener.handleEvent === \"function\") {\r\n            listener.handleEvent(event);\r\n          } else {\r\n            listener.call(this, event);\r\n          }\r\n        } catch (e) {\r\n          throwError(e);\r\n        }\r\n      }\r\n    }\r\n  };\r\n  EventTarget.prototype.addEventListener = function (type, listener) {\r\n    type = String(type);\r\n    var listeners = this._listeners;\r\n    var typeListeners = listeners[type];\r\n    if (typeListeners == undefined) {\r\n      typeListeners = [];\r\n      listeners[type] = typeListeners;\r\n    }\r\n    var found = false;\r\n    for (var i = 0; i < typeListeners.length; i += 1) {\r\n      if (typeListeners[i] === listener) {\r\n        found = true;\r\n      }\r\n    }\r\n    if (!found) {\r\n      typeListeners.push(listener);\r\n    }\r\n  };\r\n  EventTarget.prototype.removeEventListener = function (type, listener) {\r\n    type = String(type);\r\n    var listeners = this._listeners;\r\n    var typeListeners = listeners[type];\r\n    if (typeListeners != undefined) {\r\n      var filtered = [];\r\n      for (var i = 0; i < typeListeners.length; i += 1) {\r\n        if (typeListeners[i] !== listener) {\r\n          filtered.push(typeListeners[i]);\r\n        }\r\n      }\r\n      if (filtered.length === 0) {\r\n        delete listeners[type];\r\n      } else {\r\n        listeners[type] = filtered;\r\n      }\r\n    }\r\n  };\r\n\r\n  function Event(type) {\r\n    this.type = type;\r\n    this.target = undefined;\r\n  }\r\n\r\n  function MessageEvent(type, options) {\r\n    Event.call(this, type);\r\n    this.data = options.data;\r\n    this.lastEventId = options.lastEventId;\r\n  }\r\n\r\n  MessageEvent.prototype = Object.create(Event.prototype);\r\n\r\n  function ConnectionEvent(type, options) {\r\n    Event.call(this, type);\r\n    this.status = options.status;\r\n    this.statusText = options.statusText;\r\n    this.headers = options.headers;\r\n  }\r\n\r\n  ConnectionEvent.prototype = Object.create(Event.prototype);\r\n\r\n  function ErrorEvent(type, options) {\r\n    Event.call(this, type);\r\n    this.error = options.error;\r\n  }\r\n\r\n  ErrorEvent.prototype = Object.create(Event.prototype);\r\n\r\n  var WAITING = -1;\r\n  var CONNECTING = 0;\r\n  var OPEN = 1;\r\n  var CLOSED = 2;\r\n\r\n  var AFTER_CR = -1;\r\n  var FIELD_START = 0;\r\n  var FIELD = 1;\r\n  var VALUE_START = 2;\r\n  var VALUE = 3;\r\n\r\n  var contentTypeRegExp = /^text\\/event\\-stream(;.*)?$/i;\r\n\r\n  var MINIMUM_DURATION = 1000;\r\n  var MAXIMUM_DURATION = 18000000;\r\n\r\n  var parseDuration = function (value, def) {\r\n    var n = value == null ? def : parseInt(value, 10);\r\n    if (n !== n) {\r\n      n = def;\r\n    }\r\n    return clampDuration(n);\r\n  };\r\n  var clampDuration = function (n) {\r\n    return Math.min(Math.max(n, MINIMUM_DURATION), MAXIMUM_DURATION);\r\n  };\r\n\r\n  var fire = function (that, f, event) {\r\n    try {\r\n      if (typeof f === \"function\") {\r\n        f.call(that, event);\r\n      }\r\n    } catch (e) {\r\n      throwError(e);\r\n    }\r\n  };\r\n\r\n  function EventSourcePolyfill(url, options) {\r\n    EventTarget.call(this);\r\n    options = options || {};\r\n\r\n    this.onopen = undefined;\r\n    this.onmessage = undefined;\r\n    this.onerror = undefined;\r\n\r\n    this.url = undefined;\r\n    this.readyState = undefined;\r\n    this.withCredentials = undefined;\r\n    this.headers = undefined;\r\n\r\n    this._close = undefined;\r\n\r\n    start(this, url, options);\r\n  }\r\n\r\n  function getBestXHRTransport() {\r\n    return (XMLHttpRequest != undefined && (\"withCredentials\" in XMLHttpRequest.prototype)) || XDomainRequest == undefined\r\n        ? new XMLHttpRequest()\r\n        : new XDomainRequest();\r\n  }\r\n\r\n  var isFetchSupported = fetch != undefined && Response != undefined && \"body\" in Response.prototype;\r\n\r\n  function start(es, url, options) {\r\n    url = String(url);\r\n    var withCredentials = Boolean(options.withCredentials);\r\n    var lastEventIdQueryParameterName = options.lastEventIdQueryParameterName || \"lastEventId\";\r\n\r\n    var initialRetry = clampDuration(1000);\r\n    var heartbeatTimeout = parseDuration(options.heartbeatTimeout, 45000);\r\n\r\n    var lastEventId = \"\";\r\n    var retry = initialRetry;\r\n    var wasActivity = false;\r\n    var textLength = 0;\r\n    var headers = options.headers || {};\r\n    var TransportOption = options.Transport;\r\n    var xhr = isFetchSupported && TransportOption == undefined ? undefined : new XHRWrapper(TransportOption != undefined ? new TransportOption() : getBestXHRTransport());\r\n    var transport = TransportOption != null && typeof TransportOption !== \"string\" ? new TransportOption() : (xhr == undefined ? new FetchTransport() : new XHRTransport());\r\n    var abortController = undefined;\r\n    var timeout = 0;\r\n    var currentState = WAITING;\r\n    var dataBuffer = \"\";\r\n    var lastEventIdBuffer = \"\";\r\n    var eventTypeBuffer = \"\";\r\n\r\n    var textBuffer = \"\";\r\n    var state = FIELD_START;\r\n    var fieldStart = 0;\r\n    var valueStart = 0;\r\n\r\n    var onStart = function (status, statusText, contentType, headers) {\r\n      if (currentState === CONNECTING) {\r\n        if (status === 200 && contentType != undefined && contentTypeRegExp.test(contentType)) {\r\n          currentState = OPEN;\r\n          wasActivity = Date.now();\r\n          retry = initialRetry;\r\n          es.readyState = OPEN;\r\n          var event = new ConnectionEvent(\"open\", {\r\n            status: status,\r\n            statusText: statusText,\r\n            headers: headers\r\n          });\r\n          es.dispatchEvent(event);\r\n          fire(es, es.onopen, event);\r\n        } else {\r\n          var message = \"\";\r\n          if (status !== 200) {\r\n            if (statusText) {\r\n              statusText = statusText.replace(/\\s+/g, \" \");\r\n            }\r\n            message = \"EventSource's response has a status \" + status + \" \" + statusText + \" that is not 200. Aborting the connection.\";\r\n          } else {\r\n            message = \"EventSource's response has a Content-Type specifying an unsupported type: \" + (contentType == undefined ? \"-\" : contentType.replace(/\\s+/g, \" \")) + \". Aborting the connection.\";\r\n          }\r\n          close();\r\n          var event = new ConnectionEvent(\"error\", {\r\n            status: status,\r\n            statusText: statusText,\r\n            headers: headers\r\n          });\r\n          es.dispatchEvent(event);\r\n          fire(es, es.onerror, event);\r\n          console.error(message);\r\n        }\r\n      }\r\n    };\r\n\r\n    var onProgress = function (textChunk) {\r\n      if (currentState === OPEN) {\r\n        var n = -1;\r\n        for (var i = 0; i < textChunk.length; i += 1) {\r\n          var c = textChunk.charCodeAt(i);\r\n          if (c === \"\\n\".charCodeAt(0) || c === \"\\r\".charCodeAt(0)) {\r\n            n = i;\r\n          }\r\n        }\r\n        var chunk = (n !== -1 ? textBuffer : \"\") + textChunk.slice(0, n + 1);\r\n        textBuffer = (n === -1 ? textBuffer : \"\") + textChunk.slice(n + 1);\r\n        if (textChunk !== \"\") {\r\n          wasActivity = Date.now();\r\n          textLength += textChunk.length;\r\n        }\r\n        for (var position = 0; position < chunk.length; position += 1) {\r\n          var c = chunk.charCodeAt(position);\r\n          if (state === AFTER_CR && c === \"\\n\".charCodeAt(0)) {\r\n            state = FIELD_START;\r\n          } else {\r\n            if (state === AFTER_CR) {\r\n              state = FIELD_START;\r\n            }\r\n            if (c === \"\\r\".charCodeAt(0) || c === \"\\n\".charCodeAt(0)) {\r\n              if (state !== FIELD_START) {\r\n                if (state === FIELD) {\r\n                  valueStart = position + 1;\r\n                }\r\n                var field = chunk.slice(fieldStart, valueStart - 1);\r\n                var value = chunk.slice(valueStart + (valueStart < position && chunk.charCodeAt(valueStart) === \" \".charCodeAt(0) ? 1 : 0), position);\r\n                if (field === \"data\") {\r\n                  dataBuffer += \"\\n\";\r\n                  dataBuffer += value;\r\n                } else if (field === \"id\") {\r\n                  lastEventIdBuffer = value;\r\n                } else if (field === \"event\") {\r\n                  eventTypeBuffer = value;\r\n                } else if (field === \"retry\") {\r\n                  initialRetry = parseDuration(value, initialRetry);\r\n                  retry = initialRetry;\r\n                } else if (field === \"heartbeatTimeout\") {\r\n                  heartbeatTimeout = parseDuration(value, heartbeatTimeout);\r\n                  if (timeout !== 0) {\r\n                    clearTimeout(timeout);\r\n                    timeout = setTimeout(function () {\r\n                      onTimeout();\r\n                    }, heartbeatTimeout);\r\n                  }\r\n                }\r\n              }\r\n              if (state === FIELD_START) {\r\n                if (dataBuffer !== \"\") {\r\n                  lastEventId = lastEventIdBuffer;\r\n                  if (eventTypeBuffer === \"\") {\r\n                    eventTypeBuffer = \"message\";\r\n                  }\r\n                  var event = new MessageEvent(eventTypeBuffer, {\r\n                    data: dataBuffer.slice(1),\r\n                    lastEventId: lastEventIdBuffer\r\n                  });\r\n                  es.dispatchEvent(event);\r\n                  if (eventTypeBuffer === \"open\") {\r\n                    fire(es, es.onopen, event);\r\n                  } else if (eventTypeBuffer === \"message\") {\r\n                    fire(es, es.onmessage, event);\r\n                  } else if (eventTypeBuffer === \"error\") {\r\n                    fire(es, es.onerror, event);\r\n                  }\r\n                  if (currentState === CLOSED) {\r\n                    return;\r\n                  }\r\n                }\r\n                dataBuffer = \"\";\r\n                eventTypeBuffer = \"\";\r\n              }\r\n              state = c === \"\\r\".charCodeAt(0) ? AFTER_CR : FIELD_START;\r\n            } else {\r\n              if (state === FIELD_START) {\r\n                fieldStart = position;\r\n                state = FIELD;\r\n              }\r\n              if (state === FIELD) {\r\n                if (c === \":\".charCodeAt(0)) {\r\n                  valueStart = position + 1;\r\n                  state = VALUE_START;\r\n                }\r\n              } else if (state === VALUE_START) {\r\n                state = VALUE;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    var onFinish = function (error) {\r\n      if (currentState === OPEN || currentState === CONNECTING) {\r\n        currentState = WAITING;\r\n        if (timeout !== 0) {\r\n          clearTimeout(timeout);\r\n          timeout = 0;\r\n        }\r\n        timeout = setTimeout(function () {\r\n          onTimeout();\r\n        }, retry);\r\n        retry = clampDuration(Math.min(initialRetry * 16, retry * 2));\r\n\r\n        es.readyState = CONNECTING;\r\n        var event = new ErrorEvent(\"error\", {error: error});\r\n        es.dispatchEvent(event);\r\n        fire(es, es.onerror, event);\r\n        if (error != undefined) {\r\n          console.error(error);\r\n        }\r\n      }\r\n    };\r\n\r\n    var close = function () {\r\n      currentState = CLOSED;\r\n      if (abortController != undefined) {\r\n        abortController.abort();\r\n        abortController = undefined;\r\n      }\r\n      if (timeout !== 0) {\r\n        clearTimeout(timeout);\r\n        timeout = 0;\r\n      }\r\n      es.readyState = CLOSED;\r\n    };\r\n\r\n    var onTimeout = function () {\r\n      timeout = 0;\r\n\r\n      if (currentState !== WAITING) {\r\n        if (!wasActivity && abortController != undefined) {\r\n          onFinish(new Error(\"No activity within \" + heartbeatTimeout + \" milliseconds.\" + \" \" + (currentState === CONNECTING ? \"No response received.\" : textLength + \" chars received.\") + \" \" + \"Reconnecting.\"));\r\n          if (abortController != undefined) {\r\n            abortController.abort();\r\n            abortController = undefined;\r\n          }\r\n        } else {\r\n          var nextHeartbeat = Math.max((wasActivity || Date.now()) + heartbeatTimeout - Date.now(), 1);\r\n          wasActivity = false;\r\n          timeout = setTimeout(function () {\r\n            onTimeout();\r\n          }, nextHeartbeat);\r\n        }\r\n        return;\r\n      }\r\n\r\n      wasActivity = false;\r\n      textLength = 0;\r\n      timeout = setTimeout(function () {\r\n        onTimeout();\r\n      }, heartbeatTimeout);\r\n\r\n      currentState = CONNECTING;\r\n      dataBuffer = \"\";\r\n      eventTypeBuffer = \"\";\r\n      lastEventIdBuffer = lastEventId;\r\n      textBuffer = \"\";\r\n      fieldStart = 0;\r\n      valueStart = 0;\r\n      state = FIELD_START;\r\n\r\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=428916\r\n      // Request header field Last-Event-ID is not allowed by Access-Control-Allow-Headers.\r\n      var requestURL = url;\r\n      if (url.slice(0, 5) !== \"data:\" && url.slice(0, 5) !== \"blob:\") {\r\n        if (lastEventId !== \"\") {\r\n          // Remove the lastEventId parameter if it's already part of the request URL.\r\n          var i = url.indexOf(\"?\");\r\n          requestURL = i === -1 ? url : url.slice(0, i + 1) + url.slice(i + 1).replace(/(?:^|&)([^=&]*)(?:=[^&]*)?/g, function (p, paramName) {\r\n            return paramName === lastEventIdQueryParameterName ? '' : p;\r\n          });\r\n          // Append the current lastEventId to the request URL.\r\n          requestURL += (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + lastEventIdQueryParameterName +\"=\" + encodeURIComponent(lastEventId);\r\n        }\r\n      }\r\n      var withCredentials = es.withCredentials;\r\n      var requestHeaders = {};\r\n      requestHeaders[\"Accept\"] = \"text/event-stream\";\r\n      var headers = es.headers;\r\n      if (headers != undefined) {\r\n        for (var name in headers) {\r\n          if (Object.prototype.hasOwnProperty.call(headers, name)) {\r\n            requestHeaders[name] = headers[name];\r\n          }\r\n        }\r\n      }\r\n      try {\r\n        abortController = transport.open(xhr, onStart, onProgress, onFinish, requestURL, withCredentials, requestHeaders);\r\n      } catch (error) {\r\n        close();\r\n        throw error;\r\n      }\r\n    };\r\n\r\n    es.url = url;\r\n    es.readyState = CONNECTING;\r\n    es.withCredentials = withCredentials;\r\n    es.headers = headers;\r\n    es._close = close;\r\n\r\n    onTimeout();\r\n  }\r\n\r\n  EventSourcePolyfill.prototype = Object.create(EventTarget.prototype);\r\n  EventSourcePolyfill.prototype.CONNECTING = CONNECTING;\r\n  EventSourcePolyfill.prototype.OPEN = OPEN;\r\n  EventSourcePolyfill.prototype.CLOSED = CLOSED;\r\n  EventSourcePolyfill.prototype.close = function () {\r\n    this._close();\r\n  };\r\n\r\n  EventSourcePolyfill.CONNECTING = CONNECTING;\r\n  EventSourcePolyfill.OPEN = OPEN;\r\n  EventSourcePolyfill.CLOSED = CLOSED;\r\n  EventSourcePolyfill.prototype.withCredentials = undefined;\r\n\r\n  var R = NativeEventSource\r\n  if (XMLHttpRequest != undefined && (NativeEventSource == undefined || !(\"withCredentials\" in NativeEventSource.prototype))) {\r\n    // Why replace a native EventSource ?\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=444328\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=831392\r\n    // https://code.google.com/p/chromium/issues/detail?id=260144\r\n    // https://code.google.com/p/chromium/issues/detail?id=225654\r\n    // ...\r\n    R = EventSourcePolyfill;\r\n  }\r\n\r\n  (function (factory) {\r\n    if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n      var v = factory(exports);\r\n      if (v !== undefined) module.exports = v;\r\n    }\r\n    else if (typeof define === \"function\" && define.amd) {\r\n      define([\"exports\"], factory);\r\n    }\r\n    else {\r\n      factory(global);\r\n    }\r\n  })(function (exports) {\r\n    exports.EventSourcePolyfill = EventSourcePolyfill;\r\n    exports.NativeEventSource = NativeEventSource;\r\n    exports.EventSource = R;\r\n  });\r\n}(typeof globalThis === 'undefined' ? (typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : this) : globalThis));\r\n"]},"metadata":{},"sourceType":"script"}